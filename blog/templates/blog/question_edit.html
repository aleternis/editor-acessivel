{% extends 'blog/base.html' %}



{% block content %}


<form method="POST" class="post-form">{% csrf_token %}

    {{ form.media }}
    {{ form.as_p }}

    <button type="submit" class="save btn btn-default">Salvar</button>
</form>




<script>

/*$(document).ready(function() {
  // executes when HTML-Document is loaded and DOM is ready
  alert("document is ready");
});*/

$(window).load(function() {
    $('body#tinymce', $('iframe#id_text_ifr').contents()).keyup( function(e) {
        var error = false;
        var pError = "";
        var imgError = "";
        var btn = document.getElementById("id_text_ifr");
        var listP = btn.contentWindow.document.body.getElementsByTagName('p');
        var listImg = btn.contentWindow.document.body.getElementsByTagName('img');
        
        //Testar tag p
        for (i = 0; i < listP.length; i++) {
            if(listP[i].innerHTML.length> 10){
                listP[i].style.color = "red";
                pError = "<li> Paragrago " + i + " possui mais de 10 palavras</li>";
                error=true;

            }else{
              listP[i].style.color = "black";

          }
      }
      //Testar tag img
      for (i = 0; i < listImg.length; i++) {
        alt = listImg[i].getAttribute('alt');
        if (alt === '') {
            imgError = "<li> Imagem " + i + " não possui descrição</li>";
            error = true;

        }
    }
    //mostrar error e exibir pop up
    if(error){
        $('#id_text_tbl').popover({
            title :"<h4>Elementos não conforme!</h4>",
            content: "<lu>" +
            pError+
            imgError+
            "</lu>",
            container: "body",
            html: true,
        })


        $('#id_text_tbl').popover('show')
    }else{

        $('#id_text_tbl').popover('hide')
    }


});

});


</script>
{% endblock %}
